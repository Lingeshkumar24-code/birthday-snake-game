<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Birthday Snake ‚Äî Tap & Reveal (Offline)</title>
<style>
  :root{
    --bg1:#07102a; --bg2:#041028; --neon:#ff6b9e; --gold:#ffd166; --glass: rgba(255,255,255,0.04);
  }
  *{box-sizing:border-box}
  html,body{
    height:100%;
    margin:0;
    padding:0;
    font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
    color:#eef3ff;
    background:radial-gradient(800px 600px at 10% 10%, #10203b 0%, #071025 35%, #04101b 100%);
    display:flex;
    flex-direction:column;
    overflow: hidden;
    touch-action: manipulation;
  }
  .creator{ text-align:center; margin:6px 0; color:#ffd166; font-weight:bold; font-size:0.9rem; }
  .wrap{
    flex:1; display:flex; flex-direction:column; justify-content:space-between;
    width:100%; margin:0 auto; padding:8px; border-radius:18px;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border:1px solid rgba(255,255,255,0.03);
    box-shadow:0 20px 50px rgba(0,0,0,0.6);
    overflow: hidden;
  }
  .top{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}
  .title{font-weight:700;font-size:1.05rem}
  .subtitle{font-size:.83rem;opacity:.85}
  .score{background:rgba(255,255,255,0.03);padding:6px 10px;border-radius:999px;border:1px solid rgba(255,255,255,0.04);font-weight:600}
  .canvas-wrap{
    flex:1; display:flex; justify-content:center; align-items:center;
    padding:4px 0; min-height:200px;
  }
  canvas{
    border-radius:12px;
    background:linear-gradient(180deg,#06102b,#07102b);
    display:block;
    width:100%;
    height:100%;
    max-width:380px;
    box-shadow:inset 0 6px 18px rgba(0,0,0,0.5)
  }
  .controls{
    display:flex; justify-content:space-between; align-items:center;
    flex-wrap:wrap; gap:8px; margin-top:4px
  }
  .btn{
    background:var(--glass); border:1px solid rgba(255,255,255,0.03);
    color:inherit; padding:8px 12px; border-radius:10px; cursor:pointer
  }
  /* Popup */
  .popup{ position:fixed; inset:0; display:none; place-items:center; pointer-events:none; opacity:0; transition:opacity .22s; z-index:50 }
  .popup.show{ display:grid; pointer-events:auto; opacity:1 }
  .card-pop{
    width:min(92%,420px); max-width:380px;
    background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
    border-radius:14px; padding:12px; border:1px solid rgba(255,255,255,0.06);
    backdrop-filter:blur(6px); box-shadow:0 14px 40px rgba(0,0,0,0.6)
  }
  .card-pop img{ width:100%; height:210px; object-fit:cover; border-radius:10px; border:1px solid rgba(255,255,255,0.04) }
  .pop-title{ font-family:system-ui; font-size:1.3rem; color:#ffe9f3; margin-top:8px }
  @media (max-width:420px){
    .card-pop img{height:160px}
    .finale .text{font-size:2.1rem}
    .title{font-size:0.9rem}
    .subtitle{font-size:0.7rem}
  }
  .finale{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; pointer-events:none; opacity:0; transition:opacity .3s; z-index:60 }
  .finale.show{ display:flex; pointer-events:auto; opacity:1 }
  .finale .text{
    font-family: system-ui;
    font-size:2.6rem;
    background:linear-gradient(90deg,#ffd166,#ff6b9e,#9b5cff);
    -webkit-background-clip:text;
    background-clip:text;
    color:transparent;
    text-shadow:0 6px 30px rgba(0,0,0,0.6)
  }
</style>
</head>
<body>
  <div class="creator">Created by Lingesh</div>
  <div class="wrap" role="application" aria-label="Birthday Snake Game">
    <div class="top">
      <div>
        <div class="title">üêç Birthday Snake ‚Äî Tap to place treat</div>
        <div class="subtitle">Tap any empty spot to place the glowing treat ‚Äî snake will slither to it</div>
      </div>
      <div id="score" class="score">Score: 0</div>
    </div>

    <div class="canvas-wrap">
      <canvas id="gameCanvas"></canvas>
      <canvas id="confettiCanvas" style="position:absolute;left:0;top:0;pointer-events:none;"></canvas>
    </div>

    <div class="controls">
      <button id="reset" class="btn">Reset</button>
      <div style="font-size:.9rem;opacity:.9">Tap spot ‚Üí snake goes</div>
      <button id="mute" class="btn">Music ‚ô™</button>
    </div>
  </div>

  <!-- popup + finale -->
  <div id="popup" class="popup" aria-hidden="true">
    <div class="card-pop" role="dialog" aria-modal="true">
      <img id="popupImg" src="" alt="Memory image">
      <div class="pop-title" id="popupMsg">A memory</div>
      <div class="pop-sub" id="popupSub">Tap to continue</div>
    </div>
  </div>
  <div id="finale" class="finale" aria-hidden="true"><div class="text">Happy Birthday üéâ</div></div>

<script>
const messages = [
  { text: "Remember our first silly day ‚Äî that laugh still lives in me.", img: "img1.jpg" },
  { text: "The laughter we shared feels like warm sunlight on old photographs.", img: "img2.jpg" },
  { text: "Those little moments are the ones I carry with me always.", img: "img3.jpg" },
  { text: "Through ups and downs you were my steady ‚Äî thank you.", img: "img4.jpg" },
  { text: "Happy Birthday ‚Äî may this year be full of love and bright memories!", img: "img5.jpg" }
];
const MAX_EATS = 5;

const gameCanvas = document.getElementById('gameCanvas');
const ctx = gameCanvas.getContext('2d');
const confCanvas = document.getElementById('confettiCanvas');
const confCtx = confCanvas.getContext('2d');

let grid = 18;
function fitCanvas(){
  const headerH = document.querySelector('.top').offsetHeight;
  const controlsH = document.querySelector('.controls').offsetHeight;
  const availableHeight = window.innerHeight - headerH - controlsH - 20;
  const maxWidth = Math.min(window.innerWidth - 16, 380);
  const height = Math.max(200, availableHeight);
  gameCanvas.width = maxWidth;
  gameCanvas.height = height;
  confCanvas.width = maxWidth;
  confCanvas.height = height;
  grid = Math.min(18, Math.floor(Math.min(maxWidth/12, height/14)));
}
window.addEventListener('resize', fitCanvas);

let snake;
let apple = null;
let timer = null;
let baseSpeed = 140;
let speed = baseSpeed;
let running = true;
let score = 0;
let autoMode = false;
let highlight = 0;
const scoreEl = document.getElementById('score');

function rnd(n){ return Math.floor(Math.random()*n); }
function cells(){ return { x: Math.floor(gameCanvas.width / grid), y: Math.floor(gameCanvas.height / grid) }; }

function drawApple(){
  if(!apple) return;
  const cx = apple.x * grid + grid/2;
  const cy = apple.y * grid + grid/2;
  if(highlight > 0){
    confCtx.beginPath();
    const r = grid*0.8 + (28 - highlight) * 0.6;
    confCtx.fillStyle = `rgba(255,107,158,${0.14 + highlight/140})`;
    confCtx.arc(cx, cy, r, 0, Math.PI*2);
    confCtx.fill();
  }
  ctx.beginPath();
  ctx.fillStyle = '#ffd166';
  ctx.arc(cx, cy, grid*0.42, 0, Math.PI*2);
  ctx.fill();
  ctx.beginPath();
  ctx.fillStyle = 'rgba(255,255,255,0.85)';
  ctx.arc(cx - grid*0.12, cy - grid*0.14, grid*0.08, 0, Math.PI*2);
  ctx.fill();
}

function roundRect(ctx,x,y,w,h,r){ ctx.beginPath(); ctx.moveTo(x+r,y); ctx.arcTo(x+w,y,x+w,y+h,r); ctx.arcTo(x+w,y+h,x,y+h,r); ctx.arcTo(x,y+h,x,y,r); ctx.arcTo(x,y,x+w,y,r); ctx.closePath(); }
function drawSnake(){
  snake.body.forEach((p,i) => {
    const px = p.x * grid, py = p.y * grid;
    ctx.fillStyle = (i===0) ? '#ff6b9e' : '#0fe6f2';
    roundRect(ctx, px+1, py+1, grid-2, grid-2, Math.max(4, grid/5));
    ctx.fill();
    ctx.fillStyle = (i===0) ? '#ff9bb8' : '#bff8ff';
    roundRect(ctx, px+4, py+4, grid-8, grid-8, 4); ctx.fill();
  });
}

function wrapDelta(from,to,mod){
  const d = (to - from + mod) % mod;
  const right = d; const left = (mod - d) % mod;
  if(right <= left) return { steps: right, dir: 1 };
  return { steps: left, dir: -1 };
}
function chooseDirTowardApple(){
  if(!apple) return snake.dir;
  const head = snake.body[0], c = cells();
  const dx = wrapDelta(head.x, apple.x, c.x), dy = wrapDelta(head.y, apple.y, c.y);
  const primary = (dx.steps >= dy.steps) ? 'x' : 'y';
  const candidates = primary === 'x' ? [{x:dx.dir,y:0},{x:0,y:dy.dir}] : [{x:0,y:dy.dir},{x:dx.dir,y:0}];
  candidates.push({x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1});
  for(const nd of candidates){
    if(snake.body.length > 1 && snake.body[0].x + nd.x === snake.body[1].x && snake.body[0].y + nd.y === snake.body[1].y) continue;
    const next = { x: (snake.body[0].x + nd.x + c.x) % c.x, y: (snake.body[0].y + nd.y + c.y) % c.y };
    if(!snake.body.slice(1).some(p => p.x===next.x && p.y===next.y)) return nd;
  }
  return snake.dir;
}

function showPopupFor(idx){
  const m = messages[Math.min(idx, messages.length-1)];
  popupImg.src = m.img || '';
  popupMsg.textContent = m.text || 'A memory';
  popupSub.textContent = `Memory ${idx+1} of ${MAX_EATS}`;
  popup.classList.add('show');
  setTimeout(()=> { popup.classList.remove('show'); }, 2000);
}

function initSnake() {
  const c = cells();
  const startX = Math.floor(c.x / 2);
  const startY = Math.floor(c.y / 2);
  snake = {
    body: [
      { x: startX, y: startY },
      { x: startX - 1, y: startY },
      { x: startX - 2, y: startY }
    ],
    dir: { x: 1, y: 0 }
  };
}

function placeRandomApple() {
  const c = cells();
  let gx, gy;
  do {
    gx = rnd(c.x);
    gy = rnd(c.y);
  } while (snake.body.some(p => p.x === gx && p.y === gy));
  apple = { x: gx, y: gy };
  highlight = 28;
}

function faceTowardApple() {
  if (!apple) return;
  const head = snake.body[0];
  if (Math.abs(apple.x - head.x) > Math.abs(apple.y - head.y)) {
    snake.dir = { x: apple.x > head.x ? 1 : -1, y: 0 };
  } else {
    snake.dir = { x: 0, y: apple.y > head.y ? 1 : -1 };
  }
}

function tick(){
  if(!running) return;
  if(autoMode) snake.dir = chooseDirTowardApple();
  const head = { x: snake.body[0].x + snake.dir.x, y: snake.body[0].y + snake.dir.y };
  const c = cells();
  head.x = (head.x + c.x) % c.x; head.y = (head.y + c.y) % c.y;
  if(snake.body.slice(1).some(p => p.x===head.x && p.y===head.y)){ gameOver(); return; }
  snake.body.unshift(head);
  if(apple && head.x===apple.x && head.y===apple.y){
    score++; scoreEl.textContent = 'Score: ' + score;
    autoMode = false;
    showPopupFor(score-1);
    apple = null;
    if(score >= MAX_EATS){ clearInterval(timer); finalWish(); return; }
    placeRandomApple();
  } else {
    snake.body.pop();
  }
  ctx.clearRect(0,0,gameCanvas.width, gameCanvas.height);
  confCtx.clearRect(0,0,confCanvas.width, confCanvas.height);
  for(let x=0;x<gameCanvas.width/grid;x++){
    for(let y=0;y<gameCanvas.height/grid;y++){
      ctx.fillStyle = ((x+y)%2) ? '#061126' : '#071028';
      ctx.fillRect(x*grid, y*grid, grid, grid);
    }
  }
  if(highlight>0) { drawApple(); highlight--; } else drawApple();
  drawSnake();
  if(audio.paused) audio.play();
}

function finalWish(){ finaleEl.classList.add('show'); }
function gameOver(){
  running = false; clearInterval(timer);
  popupMsg.textContent = 'Game Over üí•';
  popup.classList.add('show');
}

function handleTap(e) {
  if(autoMode) return;
  const rect = gameCanvas.getBoundingClientRect();
  const clientX = e.clientX || e.touches[0].clientX;
  const clientY = e.clientY || e.touches[0].clientY;
  const gx = Math.floor((clientX - rect.left) * (gameCanvas.width / rect.width) / grid);
  const gy = Math.floor((clientY - rect.top) * (gameCanvas.height / rect.height) / grid);
  if(snake.body.some(p => p.x===gx && p.y===gy)) return;
  apple = { x: gx, y: gy }; highlight = 28; autoMode = true;
}

gameCanvas.addEventListener('click', handleTap);
gameCanvas.addEventListener('touchstart', function(e) {
  e.preventDefault();
  handleTap(e);
}, { passive: false });

document.getElementById('reset').addEventListener('click', () => {
  clearInterval(timer);
  initSnake();
  score = 0; scoreEl.textContent = 'Score: 0';
  running = true; autoMode = false; highlight = 0; apple = null;
  document.getElementById('popup').classList.remove('show'); document.getElementById('finale').classList.remove('show');
  fitCanvas();
  placeRandomApple();
  faceTowardApple();
  timer = setInterval(tick, speed);
});

document.getElementById('mute').addEventListener('click', () => { if(audio.paused) audio.play(); else audio.pause(); });

const popup = document.getElementById('popup');
const popupImg = document.getElementById('popupImg');
const popupMsg = document.getElementById('popupMsg');
const popupSub = document.getElementById('popupSub');
const finaleEl = document.getElementById('finale');

const audio = document.createElement('audio');
audio.id = 'bg';
audio.src = 'ssstik-io-1735883903828-2-65529.mp3';
audio.loop = true;
audio.volume = 0.5;
document.body.appendChild(audio);
audio.play();

fitCanvas();
initSnake();
placeRandomApple();
faceTowardApple();
timer = setInterval(tick, speed);
</script>
</body>
</html>




